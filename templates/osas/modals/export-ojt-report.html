{% block export-ojt-reports %}
<div id="reportExportModal" class="modal">
    <div class="modal-overlay" onclick="closeReportExportModal()"></div>
    <div class="modal-container wide-modal">
        <div class="modal-header">
            <div class="header-content">
                <h2>Export OJT Reports Data</h2>
                <p class="header-description">Choose what reports to export</p>
            </div>
            <button class="modal-close" onclick="closeReportExportModal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--white)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <form id="reportExportForm" class="approval-form" method="post" action="{% url 'export-ojt-reports' %}">
            {% csrf_token %}
            <div class="form-body">
                <div class="form-intro">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    <p>Export OJT reports data with comprehensive filtering options in Excel format.</p>
                </div>

                <div id="reportExportFormResponse" class="form-response"></div>

                <div class="form-main-layout">
                    <div class="form-column">
                        <div class="form-section">
                            <h3 class="section-title">Export Filters</h3>

                            <!-- Quick Presets -->
                            <div class="form-group">
                                <label>Quick Presets</label>
                                <div class="preset-buttons">
                                    <button type="button" class="preset-btn" onclick="applyPreset('all')">All Reports</button>
                                    <button type="button" class="preset-btn" onclick="applyPreset('submitted')">Submitted Only</button>
                                    <button type="button" class="preset-btn" onclick="applyPreset('reviewed')">Reviewed Only</button>
                                    <button type="button" class="preset-btn" onclick="applyPreset('weekly')">Weekly Only</button>
                                    <button type="button" class="preset-btn" onclick="applyPreset('monthly')">Monthly Only</button>
                                </div>
                                <small class="form-hint">Quickly apply common filter combinations</small>
                            </div>

                            <!-- Status Filter -->
                            <div class="form-group">
                                <label>Status Filter</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="status_submitted" value="submitted" checked>
                                        <span>Submitted</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="status_reviewed" value="reviewed" checked>
                                        <span>Reviewed</span>
                                    </label>
                                </div>
                                <small class="form-hint">Select which status to include</small>
                            </div>

                            <!-- Report Type Filter -->
                            <div class="form-group">
                                <label>Report Type Filter</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="type_weekly" value="weekly" checked>
                                        <span>Weekly Reports</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="type_monthly" value="monthly" checked>
                                        <span>Monthly Reports</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="type_final" value="final" checked>
                                        <span>Final Reports</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="type_incident" value="incident" checked>
                                        <span>Incident Reports</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="type_complaint" value="complaint" checked>
                                        <span>Complaint Reports</span>
                                    </label>
                                </div>
                                <small class="form-hint">Select which report types to include</small>
                            </div>

                            <!-- Date Range Section -->
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enableDateRange" name="enable_date_range">
                                    <span>Filter by Date Range</span>
                                </label>
                                <small class="form-hint">Export reports within a specific date period</small>
                            </div>

                            <div id="dateRangeSection" class="form-group" style="display: none;">
                                <div class="date-range-group">
                                    <div class="date-input-group">
                                        <label for="startDate">Start Date</label>
                                        <input type="date" id="startDate" name="start_date" class="form-input">
                                    </div>
                                    <div class="date-input-group">
                                        <label for="endDate">End Date</label>
                                        <input type="date" id="endDate" name="end_date" class="form-input">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-column">
                        <div class="form-section">
                            <h3 class="section-title">Export Options</h3>

                            <div class="form-group">
                                <label for="exportReportTitle">Report Title</label>
                                <input type="text" id="exportReportTitle" name="export_title" class="form-input"
                                       placeholder="OJT Reports Export" value="OJT Reports Export">
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeAttachments" name="include_attachments">
                                    <span>Include attachments info</span>
                                </label>
                                <small class="form-hint">Include attachment counts and file information</small>
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="includeReviewDetails" name="include_review_details" checked>
                                    <span>Include review details</span>
                                </label>
                                <small class="form-hint">Include reviewer information and feedback</small>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3 class="section-title">Export Preview</h3>
                            <div class="export-preview">
                                <div class="preview-item">
                                    <strong>Selected Status:</strong>
                                    <span id="previewStatus">All Status</span>
                                </div>
                                <div class="preview-item">
                                    <strong>Selected Types:</strong>
                                    <span id="previewReportTypes">All Types</span>
                                </div>
                                <div class="preview-item">
                                    <strong>Date Range:</strong>
                                    <span id="previewDateRange">All Dates</span>
                                </div>
                                <div class="preview-item">
                                    <strong>Includes Attachments:</strong>
                                    <span id="previewAttachments">No</span>
                                </div>
                                <div class="preview-item">
                                    <strong>Includes Review Details:</strong>
                                    <span id="previewReviewDetails">Yes</span>
                                </div>
                                <div class="preview-item">
                                    <strong>File Format:</strong>
                                    <span>Excel (.xlsx)</span>
                                </div>
                                <div class="preview-item">
                                    <strong>Estimated Records:</strong>
                                    <span id="previewRecordCount">Calculating...</span>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3 class="section-title">Export Summary</h3>
                            <div class="export-summary">
                                <div class="summary-item">
                                    <i class='bx bx-info-circle'></i>
                                    <div>
                                        <strong>Format:</strong> Professional Excel report
                                    </div>
                                </div>
                                <div class="summary-item">
                                    <i class='bx bx-time'></i>
                                    <div>
                                        <strong>Generated:</strong> <span id="currentTime"></span>
                                    </div>
                                </div>
                                <div class="summary-item">
                                    <i class='bx bx-data'></i>
                                    <div>
                                        <strong>Includes:</strong> Report metadata, content, status tracking
                                    </div>
                                </div>
                                <div class="summary-item">
                                    <i class='bx bx-filter-alt'></i>
                                    <div>
                                        <strong>Filters Applied:</strong> <span id="previewFilters">All data</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" onclick="closeReportExportModal()">Cancel</button>
                <button type="submit" class="btn btn-primary" id="exportSubmitBtn">
                    <span class="btn-text">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Export to Excel
                    </span>
                    <span class="btn-loader">
                        <svg viewBox="0 0 50 50">
                            <circle cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                        </svg>
                    </span>
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock export-ojt-reports %}