{% block edit-ojt-application %}
<div id="editOJTApplicationModal" class="modal">
    <div class="modal-overlay" onclick="closeOJTApplicationEditModal()"></div>
    <div class="modal-container" style="max-width: 900px;">
        <div class="modal-header">
            <div class="header-content">
                <h2>Edit OJT Application</h2>
                <p class="header-description">Update application details and manage requirements</p>
            </div>
            <button class="modal-close" onclick="closeOJTApplicationEditModal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--white)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <form id="ojtApplicationEditForm" method="post" action="" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-body">
                <div class="form-intro">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    <p>Update the OJT application information below. Fields marked with <span class="required-asterisk">*</span> are required.</p>
                </div>

                <div id="ojtApplicationEditFormResponse" class="form-response"></div>
                <input type="hidden" name="application_id" id="editOJTApplicationId">

                <!-- Application Information -->
                <div class="form-section">
                    <h3 class="section-title">Application Information</h3>
                    <div class="form-columns">
                        <div class="form-column">
                            <div class="form-group">
                                <label for="editOJTStudentName">Student Name</label>
                                <input type="text" id="editOJTStudentName" class="form-input" readonly>
                            </div>

                            <div class="form-group">
                                <label for="editOJTCourseSection">Course & Section</label>
                                <input type="text" id="editOJTCourseSection" class="form-input" readonly>
                            </div>

                            <div class="form-group">
                                <label for="editOJTCompany">Company <span class="required-asterisk">*</span></label>
                                <select name="company" id="editOJTCompany" class="form-input" required>
                                    <option value="">Select a company...</option>
                                    <!-- Companies will be populated dynamically -->
                                </select>
                            </div>
                        </div>

                        <div class="form-column">
                            <div class="form-group">
                                <label for="editOJTStudentNumber">Student Number</label>
                                <input type="text" id="editOJTStudentNumber" class="form-input" readonly>
                            </div>

                            <div class="form-group">
                                <label for="editOJTYearLevel">Year Level</label>
                                <input type="text" id="editOJTYearLevel" class="form-input" readonly>
                            </div>

                            <div class="form-group">
                                <label for="editOJTApplicationStatus">Current Status</label>
                                <input type="text" id="editOJTApplicationStatus" class="form-input" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- OJT Period -->
                <div class="form-section">
                    <h3 class="section-title">OJT Period</h3>
                    <div class="form-columns">
                        <div class="form-column">
                            <div class="form-group">
                                <label for="editOJTStartDate">Start Date <span class="required-asterisk">*</span></label>
                                <input type="date" name="proposed_start_date" id="editOJTStartDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="editOJTDurationDays">Duration (Days)</label>
                                <input type="text" id="editOJTDurationDays" class="form-input" readonly>
                            </div>
                        </div>

                        <div class="form-column">
                            <div class="form-group">
                                <label for="editOJTEndDate">End Date <span class="required-asterisk">*</span></label>
                                <input type="date" name="proposed_end_date" id="editOJTEndDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="editOJTHours">Proposed Hours <span class="required-asterisk">*</span></label>
                                <input type="number" name="proposed_hours" id="editOJTHours" class="form-input" min="240" max="1000" required>
                                <small class="help-text">Minimum 240 hours, maximum 1000 hours</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Application Details -->
                <div class="form-section">
                    <h3 class="section-title">Application Details</h3>
                    <div class="form-group">
                        <label for="editOJTCoverLetter">Cover Letter</label>
                        <textarea name="cover_letter" id="editOJTCoverLetter" class="form-input" rows="4" placeholder="Explain why you want to do OJT at this company..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="editOJTSkills">Skills & Qualifications</label>
                        <textarea name="skills" id="editOJTSkills" class="form-input" rows="3" placeholder="List your relevant skills and qualifications..."></textarea>
                    </div>
                </div>

                <!-- Requirements Management Section -->
                <div class="form-section">
                    <h3 class="section-title">Requirements Management</h3>

                    <!-- Requirements Summary -->
                    <div class="requirements-summary">
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="summary-value" id="editTotalRequirements">0</span>
                                <span class="summary-label">Total Requirements</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-value" id="editUploadedRequirements">0</span>
                                <span class="summary-label">Uploaded</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-value" id="editPendingRequirements">0</span>
                                <span class="summary-label">Pending</span>
                            </div>
                        </div>
                        <div class="upload-progress">
                            <div class="progress-bar" id="editCompletionProgress">
                                <span class="progress-text" id="editProgressText">0%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Existing Requirements List -->
                    <div class="existing-requirements">
                        <h4>Existing Requirements</h4>
                        <div id="editExistingRequirementsList" class="requirements-list">
                            <!-- Existing requirements will be populated here -->
                        </div>
                    </div>

                    <!-- Add New Requirements -->
                    <div class="add-requirements-section">
                        <h4>Add New Requirements</h4>
                        <div class="form-text">
                            Upload additional requirement documents. Each requirement must include a document type and file.
                        </div>

                        <!-- Drag and Drop Zone -->
                        <div class="drop-zone" id="editDropZone">
                            <div class="drop-zone-content">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                                <p>Drag and drop files here or click "Add Requirement" below</p>
                                <small class="form-text">Supported formats: PDF, DOC, DOCX, JPG, PNG (Max 5MB per file)</small>
                            </div>
                        </div>

                        <!-- New Requirements Container -->
                        <div id="editNewRequirementsContainer">
                            <!-- New requirement fields will be added here -->
                        </div>

                        <!-- Add Requirement Button -->
                        <button type="button" id="editAddRequirement" class="add-requirement">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add Requirement
                        </button>
                    </div>
                </div>

                <!-- Company Information -->
                <div class="form-section">
                    <h3 class="section-title">Selected Company Information</h3>
                    <div class="company-preview" id="editOJTCompanyPreview">
                        <div class="company-info">
                            <strong id="editOJTCompanyName">-</strong>
                            <div class="company-details">
                                <span id="editOJTCompanyAddress">-</span>
                                <span id="editOJTCompanyContact">-</span>
                                <span id="editOJTCompanySlots" class="slots-info">Slots: -</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" onclick="closeOJTApplicationEditModal()">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <span class="btn-text">Update Application</span>
                    <span class="btn-loader">
                        <svg viewBox="0 0 50 50">
                            <circle cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                        </svg>
                    </span>
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock edit-ojt-application %}