<div id="companyExportModal" class="modal">
  <div class="modal-overlay" onclick="closeCompanyExportModal()"></div>
  <div class="modal-container wide-modal">
    <div class="modal-header">
      <div class="header-content">
        <h2>Export OJT Companies Data</h2>
        <p class="header-description">Export companies using professional template</p>
      </div>
      <button class="modal-close" onclick="closeCompanyExportModal()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--white)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <form id="companyExportForm" class="approval-form" method="post" action="{% url 'export-ojt-companies' %}">
      {% csrf_token %}
      <div class="form-body">
        <div class="form-intro">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          <p>Export company information using the professional OJT Company Template format.</p>
        </div>

        <div id="companyExportFormResponse" class="form-response"></div>

        <div class="form-main-layout">
          <div class="form-column">
            <div class="form-section">
              <h3 class="section-title">Export Scope</h3>

              <div class="form-group">
                <label for="exportType">Companies to Export</label>
                <select id="exportType" name="export_type" class="form-input" onchange="handleExportTypeChange()">
                  <option value="all">All Companies</option>
                  <option value="by_status">By Status</option>
                </select>
              </div>

              <div id="statusFilterSection" class="form-group" style="display: none;">
                <label for="statusFilter">Select Status</label>
                <select id="statusFilter" name="status_filter" class="form-input">
                  <option value="active">Active Companies</option>
                  <option value="inactive">Inactive Companies</option>
                </select>
                <small class="form-hint">Choose whether to export active or inactive companies</small>
              </div>

              <div class="form-group">
                <label for="exportCompanyTitle">Report Title</label>
                <input type="text" id="exportCompanyTitle" name="export_title" class="form-input"
                       placeholder="OJT Companies Report" value="OJT Companies Report">
                <small class="form-hint">This will appear as the main title in the exported file</small>
              </div>

              <div class="form-group">
                <div class="template-info">
                  <i class='bx bx-file'></i>
                  <div>
                    <strong>Using Template:</strong> OJTTemplate.xlsx
                    <br>
                    <small>Data will be populated into the pre-designed template format</small>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3 class="section-title">Export Summary</h3>
              <div class="export-summary">
                <div class="summary-item">
                  <i class='bx bx-info-circle'></i>
                  <div>
                    <strong>Format:</strong> Professional Template
                  </div>
                </div>
                <div class="summary-item">
                  <i class='bx bx-time'></i>
                  <div>
                    <strong>Generated:</strong> <span id="currentTime"></span>
                  </div>
                </div>
                <div class="summary-item">
                  <i class='bx bx-data'></i>
                  <div>
                    <strong>Template:</strong> OJTTemplate.xlsx
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-column">
            <div class="form-section">
              <h3 class="section-title">Export Preview</h3>
              <div class="export-preview">
                <div class="preview-item">
                  <strong>Export Type:</strong>
                  <span id="previewExportType">All Companies</span>
                </div>
                <div class="preview-item">
                  <strong>Status Filter:</strong>
                  <span id="previewStatusFilter">-</span>
                </div>
                <div class="preview-item">
                  <strong>File Format:</strong>
                  <span>Excel (.xlsx) with Template</span>
                </div>
                <div class="preview-item">
                  <strong>Columns Included:</strong>
                  <span id="previewColumns">Company Name, Address, Contact Number, Email, Status</span>
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3 class="section-title">Template Columns</h3>
              <div class="template-columns">
                <div class="columns-grid">
                  <div class="column-item">
                    <span class="column-number">A</span>
                    <span class="column-name">Name</span>
                  </div>
                  <div class="column-item">
                    <span class="column-number">B</span>
                    <span class="column-name">Address</span>
                  </div>
                  <div class="column-item">
                    <span class="column-number">C</span>
                    <span class="column-name">Contact No</span>
                  </div>
                  <div class="column-item">
                    <span class="column-number">D</span>
                    <span class="column-name">Email</span>
                  </div>
                  <div class="column-item">
                    <span class="column-number">E</span>
                    <span class="column-name">Description</span>
                  </div>
                  <div class="column-item">
                    <span class="column-number">F</span>
                    <span class="column-name">Status</span>
                  </div>
                  <div class="column-item">
                    <span class="column-number">G</span>
                    <span class="column-name">Website</span>
                  </div>
                </div>
                <small class="form-hint">Data will be populated exactly matching the template layout</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" onclick="closeCompanyExportModal()">Cancel</button>
        <button type="submit" class="btn btn-primary" id="exportSubmitBtn">
          <span class="btn-text">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Export
          </span>
          <span class="btn-loader">
            <svg viewBox="0 0 50 50">
              <circle cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
            </svg>
          </span>
        </button>
      </div>
    </form>
  </div>
</div>